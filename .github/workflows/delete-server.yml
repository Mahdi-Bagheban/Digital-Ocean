name: ðŸ—‘ï¸ Delete Development Server

on:
  workflow_dispatch:
    inputs:
      confirm:
        description: 'Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù "yes" ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯'
        required: true
        default: 'no'

jobs:
  delete-server:
    runs-on: ubuntu-latest
    
    steps:
      - name: âœ… Ø¨Ø±Ø±Ø³ÛŒ ØªØ£ÛŒÛŒØ¯
        if: github.event.inputs.confirm != 'yes'
        run: |
          echo "âŒ Ø­Ø°Ù Ù„ØºÙˆ Ø´Ø¯. Ø¨Ø§ÛŒØ¯ 'yes' ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯"
          exit 1
      
      - name: ðŸ“¥ Checkout Ú©Ø¯
        uses: actions/checkout@v4
      
      - name: ðŸ”§ Ù†ØµØ¨ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§
        run: |
          sudo apt-get update
          sudo apt-get install -y jq bc
      
      - name: ðŸ“¥ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³Ø±ÙˆØ±
        uses: actions/download-artifact@v4
        with:
          name: server-info
        continue-on-error: true
      
      - name: ðŸ” ØªÙ†Ø¸ÛŒÙ… Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…Ø­ÛŒØ·ÛŒ
        run: |
          echo "DO_API_TOKEN=${{ secrets.DO_API_TOKEN }}" > .env
      
      - name: ðŸ—‘ï¸ Ø­Ø°Ù Ø³Ø±ÙˆØ±
        run: |
          chmod +x delete-server.sh
          # Ù¾Ø§Ø³Ø® Ø®ÙˆØ¯Ú©Ø§Ø± 'yes' Ø¨Ù‡ Ø³ÙˆØ§Ù„ ØªØ£ÛŒÛŒØ¯
          echo "yes" | ./delete-server.sh
      
      - name: ðŸ“Š Ù†Ù…Ø§ÛŒØ´ Ø®Ù„Ø§ØµÙ‡
        if: always()
        run: |
          echo "## âœ… Ø³Ø±ÙˆØ± Ø­Ø°Ù Ø´Ø¯" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Ø³Ø±ÙˆØ± ØªÙˆØ³Ø¹Ù‡ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø² DigitalOcean Ø­Ø°Ù Ø´Ø¯." >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸ’° Ù‡Ø²ÛŒÙ†Ù‡ Ù†Ù‡Ø§ÛŒÛŒ Ø¯Ø± Ø­Ø³Ø§Ø¨ DigitalOcean Ø´Ù…Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯." >> $GITHUB_STEP_SUMMARY
